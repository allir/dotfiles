# Aliases
alias ll='ls -alF'
alias lt='du -sh * | sort -h'
alias left='ls -t -1'
alias depth="find . -type d | awk -F\"/\" 'NF > max {max = NF-1} END {print max}'"
alias myip='dig @resolver1.opendns.com myip.opendns.com +short'
alias cpv='rsync -ah --info=progress2'
alias trash='mv --force -t ~/.Trash '
alias mnt="mount | awk -F' ' '{ printf \"%s\t%s\n\",\$1,\$3; }' | column -t | egrep ^/dev/ | sort"
alias starwars='nc towel.blinkenlights.nl 23'

# Aliases replacing common commands when possible
if command -v bat &>/dev/null; then
  alias cat='bat --style=plain --paging=never'
fi
if command -v prettyping &>/dev/null; then
  alias ping='prettyping --nolegend'
fi

# Homebrew
alias brewdeps="brew leaves | xargs brew deps --installed --for-each"
alias brewtree="brew leaves | xargs brew deps --installed --tree"

# Python
alias ve='python3 -m venv ./venv'
alias va='source ./venv/bin/activate'

# Git
alias gitroot='cd `git rev-parse --show-toplevel`'
alias gitno='git --no-pager'
git-prune(){
  git fetch --prune &>/dev/null && \
  git branch -vv | grep origin | grep gone | awk '{print $1}' | xargs -L 1 git branch -D 2>/dev/null || echo "Nothing to do..."
}

# Docker/Kubernetes
kube(){
  export KUBECONFIG=~/.kube/configs/${1}
}
kubedecode(){
  kubectl get secret -o json $* | jq -r '.data | map_values(@base64d)'
}
daemoncat(){
  kubectl exec -ti -n daemoncat $* -- nsenter -t 1 -m -i -n -u bash
}
alias d='docker'
alias k='kubectl'
alias fine='docker run -it --rm ghcr.io/pdevine/thisisfine'

## Prunes all duplicates from history
history-prune(){
  tac "$HISTFILE" | awk '!x[$0]++' > /tmp/history && tac /tmp/history > "$HISTFILE" && rm /tmp/history
}
## History stats
history-top(){
  history | awk '{print $2;}' | sort | uniq -c | sort -rn | head -10
}
history-tops(){
  history | sed -e 's/ *[0-9][0-9]* *//' | sort | uniq -c | sort -rn | head -10
}
